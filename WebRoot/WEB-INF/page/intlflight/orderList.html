<!DOCTYPE html>
<html>

	<head>
		<meta charset="UTF-8">
		<meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no" />
		<title>订单填写</title>
		<link rel="stylesheet" type="text/css" href="../css/allOrder.css" />
	</head>

	<body>
		<div class="bounceds bounced">
			<div class="boun-con">
				<p class="change">退改政策</p>
				<div class="content-space">
					<div class="con-top color">
						<p>
							<img src="../img/type.png" /> 海航HU7619
						</p>
						<div class="start">
							<h3>09:20</h3>
							<p>首都T2有餐饮有餐饮</p>
						</div>
						<p>波音787大机型</p>

					</div>
					<div class="con-top con-mid">
						<p style="margin-top: 0.2rem;">02-24</p>
						<div class="fly">
							<p style="color: #11b4ed;">直飞</p>
							<img src="../img/zhifei.png" style="width: 9rem;" />
						</div>
						<p></p>

					</div>
					<div class="con-top color con-bot">
						<p>总时长约2时25分</p>
						<div class="finish">
							<h3>11:45</h3>
							<p>虹桥T1</p>
						</div>
						<p>因公出行</p>
					</div>
				</div>
				<div class="closedBtn">
					<img src="../img/close.png" />
				</div>
			</div>
		</div>
		<div class="bounced bun">
			<div class="tips">
				<p class="change">退改政策</p>
				<div class="contents">
					<div style="margin-bottom: 0.2rem;">
						<p>
							<span>退票条件</span>
						</p>
						<p>(一)航班规定离站时间2小时之前，30%；(二)航班规定离站时间2小时以内及飞后，50%；</p>
					</div>
					<p>
						<span>签转条件</span> 以实际航班日期为准，航前和航后的判定标准以航班起飞前2小时作为时间划分截点:
					</p>
					<p>(一)航班规定离站时间2小时之前，20%；(二)航班规定离站时间2小时以内及飞后，30%。改期费与升舱费同时发生时，则同时需要收取改期费和升舱费差额。不得签转</p>
				</div>
				<div class="closedBtn">
					<img src="../img/close.png" />
				</div>
			</div>
		</div>
		<div class="bounced payment">
			<div class="payment-con" id="tested">
				<div class="payment-title">
					<p>结算方式类型</p>
				</div>
				<div class="payment-choose">
					<p>
						<span>预付款支付</span>
						<img src="../img/choose.png" / class="selected">
					</p>
					<p>
						<span>公司现结</span>
						<img src="../img/choose.png" / class="selected">
					</p>
					<p>
						<span>个人支付</span>
						<img src="../img/choose.png" / class="selected">
					</p>
				</div>
			</div>
		</div>
		<div class="bounced instructe">
			<div class="payment-con" id="test">
				<div class="payment-title">
					<p>
						<p>差旅说明类型</p>
					</p>
				</div>
				<div class="payment-choose">
					<p>
						<span>起飞或达到时间不合适</span>
						<img src="../img/choose.png" / class="selected">
					</p>
					<p>
						<span>航空公司喜好</span>
						<img src="../img/choose.png" / class="selected">
					</p>
					<p>
						<span>票价限制条件</span>
						<img src="../img/choose.png" / class="selected">
					</p>
					<p>
						<span>里程选择</span>
						<img src="../img/choose.png" / class="selected">
					</p>
					<p>
						<span>其他</span>
						<img src="../img/choose.png" / class="selected">
					</p>
				</div>
			</div>
		</div>
		<div class="bounced department">
			<div class="payment-con" id="tests">
				<div class="payment-title">
					<p>
						<p>费用归属部门名称</p>
					</p>
				</div>
				<div class="payment-choose">
					<p>
						<span>人事部</span>
						<img src="../img/choose.png" / class="selected">
					</p>
					<p>
						<span>行政部</span>
						<img src="../img/choose.png" / class="selected">
					</p>
					<p>
						<span>销售部</span>
						<img src="../img/choose.png" / class="selected">
					</p>
				</div>
			</div>
		</div>
		<div class="pages" style="display: none;">
			<header class="addH">
				<div class="turnIcon">
					<img src="../img/header.png" />
				</div>
				<div class="title"></div>
				<div class="login">
					<img src="../img/addBtn.png">
				</div>
			</header>
			<section>
				<div class="Tab">
					<div class="tabTitle">
						<div class="flyer highlight">企业员工</div>
						<div class="flyer">常旅客</div>
					</div>
					<div class="tabContent">
						<ul class="show">
							<li>
								<p><span class="passener-name">田晓</span></p>
								<p>
									<span class="name">手机号</span>
									<span class="passener-phone">15512851217</span>
								</p>
								<p>
									<span class="name">身份证</span>
									<span class="passener-type">14162188743921187</span>
								</p>
							</li>
							<li>
								<p><span class="passener-name">哈哈哈哈</span></p>
								<p>
									<span class="name">手机号</span>
									<span class="passener-phone">15512851217</span>
								</p>
								<p>
									<span class="name">身份证</span>
									<span class="passener-type">14162188743921187</span>
								</p>
							</li>
							<li>
								<p><span class="passener-name">田晓真</span></p>
								<p>
									<span class="name">手机号</span>
									<span class="passener-phone">15512851217</span>
								</p>
								<p>
									<span class="name ">身份证</span>
									<span class="passener-type">14162188743921187</span>
								</p>
							</li>
							<li>
								<p><span class="passener-name">田晓燕</span></p>
								<p>
									<span class="name">手机号</span>
									<span class="passener-phone">15512851217</span>
								</p>
								<p>
									<span class="name">身份证</span>
									<span class="passener-type">14162188743921187</span>
								</p>
							</li>
						</ul>
						<ul>
							<li>
								<p class="editor">
									<span class="passener-name">田晓</span>
									<span class="edit"><img src="../img/bianji.png"/></span>
								</p>
								<p>
									<span class="name">手机号</span>
									<span class="passener-phone">15512851217</span>
								</p>
								<p>
									<span class="name">身份证</span>
									<span class="passener-type">14162188743921187</span>
								</p>
							</li>
							<li>
								<p class="editor">
									<span class="passener-name">田晓真</span>
									<span class="edit"><img src="../img/bianji.png"/></span>
								</p>
								<p>
									<span class="name">手机号</span>
									<span class="passener-phone">15512851217</span>
								</p>
								<p>
									<span class="name">身份证</span>
									<span class="passener-type">14162188743921187</span>
								</p>
							</li>
							<li>
								<p class="editor">
									<span class="passener-name">田晓燕</span>
									<span class="edit"><img src="../img/bianji.png"/></span>
								</p>
								<p>
									<span class="name">手机号</span>
									<span class="passener-phone">15512851217</span>
								</p>
								<p>
									<span class="name">身份证</span>
									<span class="passener-type">14162188743921187</span>
								</p>
							</li>
						</ul>
					</div>
				</div>
			</section>
		</div>
		<div class="wrap">
			<div class="headerS"></div>
			<section>
				<div class="flightD">
					<div class="detailM">
						<div>
							<p class="detailT">
								<span class="topDate gap">02月24日</span>
								<span class="week gap">周五</span>
								<span class="topTime gap">09：00</span>
								<span class="topType">
								<img src="../img/type.png"/>
								<span>海航HU7819</span>
								</span>
							</p>
							<p class="detailB">
								<span class="gap">首都T2—中部航空</span>
								<span>中转首尔约10h25m</span>
							</p>
						</div>
						<div class="imgIcon">
							<img src="../img/you.png" / class="chooseR">
						</div>
					</div>
					<div class="travel">
						<p>
							<span class="priv">经济舱优惠舱</span>
							<span>因公出行</span>
						</p>
						<div class="travelB">
							<p>
								<span>含税票价:<span class="money"><span>¥</span><span class="fare">388</span></span>
								</span>
								<span>总时长约10h25m</span>
							</p>
							<p>
								<a href="javascript:;" class="btna">改退政策</a>
							</p>
						</div>
					</div>
				</div>
				<ul class="orderFill">
					<li class="fillList">
						<div class="airp">
							<p>乘机人</p>
							<p>
								<img src="../img/add.png" / id="imgEd">
							</p>
						</div>
						<ul id="passener">

						</ul>
					</li>
					<li class="fillList">
						<div class="airp">
							<p>通知人</p>
							<p>
								<img src="../img/add.png" / class="imgs">
							</p>
						</div>
						<ul id="notify">
						</ul>
					</li>
					<li class="fillList">
						<div class="explain">
							<p>差旅说明</p>
							<p class="module">
								<span class="insurance-type">起飞或到达时间不合适</span>
								<span>
								<img src="../img/you.png"/ class="chooseR">
							</span>
							</p>
						</div>
						<div class="explain">
							<p>
								结算方式
							</p>
							<p class="module">
								<span class="payment-type">预付款支付</span>
								<span>
								<img src="../img/you.png"/ class="chooseR">
							</span>
							</p>
						</div>
					</li>
					<li class="fillList">
						<div class="airp">
							<p>订单审核人</p>
							<p>
								<img src="../img/add.png" / class="imgs">
							</p>
						</div>
						<ul id="reviewer">
						</ul>
					</li>
				</ul>
			</section>
			<footer class="footer">
				<p class="price"><span class=" total">总价：</span><span>¥</span><span class="totalP">0</span></p>
				<p class="true">确认</p>
			</footer>
		</div>
	</body>
	<script type="text/javascript" src="../libs/jquery.min.js"></script>
	<script type="text/javascript" src="../libs/Myconfirm.js"></script>
	<script type="text/javascript">
		/*---页面加载头部---------*/

		$(".headerS").load("header.html", function(data) {
			$('header div img').on('click', function() {
				window.history.back(-1);
			});
		});

		/*------------保险开关的点击事件-----*/
		var flag;
		$('body').on('click', '#circleBtn', function() {
				if(!this.flag) {
					$(this).attr('class', 'close');
					$(this).parents('.circle').css('background', '#CCCCCC')
				} else {
					$(this).attr('class', 'circleBtn');
					$(this).parents('.circle').css('background', '#00AFEC')
				}
				this.flag = !this.flag;
			})
			/*---------点击确认的事件------*/
		$('.true').on('click', function() {
			addPeople();
		});

		function addPeople() {
			/*---判断乘机人是否添加--------*/
			if($('#passener').find('li').length == 0) {
				mess = "请添加乘机人";
				showMessage(mess);
				return false;
			}
			/*----通知人是否有添加-------*/
			if($('#notify').find('li').length == 0) {
				mess = "请添加通知人";
				showMessage(mess);
				return false;
			}
			/*----订单审核人是否有添加--------*/
			if($('#reviewer').find('li').length == 0) {
				mess = "请添加订单审核人";
				showMessage(mess);
				return false;
			}
			var dates = $('.price .totalP').html();
			window.location.href = "pay.html?name=" + dates;
		};

		function showMessage(mess) {
			$(this).MyConfirm({
				content: mess
			});
		}

		/*该退政策提示框的显示和隐藏*/

		$('.btna').on('click', function() {
			tipeShow('.bun');
		});
		$('.closedBtn img').on('click', function() {
			$('.bounced').fadeOut();
		});
		/*航班详情提示框的显示和隐藏*/
		$('.chooseR').eq(0).on('click', function() {
			tipeShow('.bounceds');
		});

		function tipeShow(objShow) {
			$(objShow).fadeIn();
		}

		/*----差旅说明和结算方式的默认样式-----*/
		function defalutStyles(objStyles) {
			$(objStyles).eq(0).css('color', '#00AFEC');
			$(objStyles).find('.selected').eq(0).show();
		};
		defalutStyles('.payment .payment-choose p'); //结算方式
		defalutStyles('.instructe .payment-choose p'); //差旅说明
		defalutStyles('.department .payment-choose p'); //费用归属

		/*------结算方式种类的效果实现----------*/
		var nums = ($('.payment .payment-choose p').length + 1) * 80 / 20 + 'rem';
		$('.module').eq(1).on('click', function() {
			layerShow('.payment', '.payment .payment-con', nums)
		});
		$('.payment .payment-choose p').on('click', function() {
			chooseContent($(this), '.payment');
			$('.payment-type').html($(this).find('span').eq(0).html());
		});

		/*----------差旅说明类型的效果实现----------*/
		var num = ($('.instructe .payment-choose p').length + 1) * 80 / 20 + 'rem';

		$('.module').eq(0).on('click', function() {
			layerShow('.instructe', '.instructe .payment-con', num);
		});
		$('.instructe .payment-choose p').on('click', function() {
			chooseContent($(this), '.instructe');
			$('.insurance-type').html($(this).find('span').eq(0).html());
		});

		/*------------结算方式、差旅说明、费用归属的遮罩层及内容展开的共同样式-------*/
		function layerShow(obj, attrObj, numLength) {
			var height = $("body").height();
			$('.bounced').height(height);
			$(obj).fadeIn();
			$(attrObj).animate({
				height: numLength
			}, 1000)
		};
		/*--------点击除了div以外所有的空白区域，div隐藏---------*/

		$('.instructe').bind('click', function(e) {
			hideLayer(e, 'test', '#test');
		});

		$('.payment').bind('click', function(e) {
			hideLayer(e, 'tested', '#tested');
		});
		$('.department').bind('click', function(e) {
			hideLayer(e, 'tests', '#tests');
		});
		/*-----删除除了div之外任何区域，遮罩层隐藏----------*/
		function hideLayer(e, Obj, idAttr) {
			var e = e || window.event; //浏览器兼容性   
			var elem = e.target || e.srcElement;
			while(elem) { //循环判断至跟节点，防止点击的是div子元素   
				if(elem.id && elem.id == Obj) {
					return;
				}
				elem = elem.parentNode;
			}
			$(idAttr).parents('.bounced').css('display', 'none'); //点击的不是div或其子元素 
		}

		/*---------添加乘机人----------*/
		$('body').on('click', '#imgEd', function() {
			$('.addH .title').html('添加乘机人')
			$('.pages').fadeIn();
			$('.wrap').fadeOut();
			var id = "passener";
			$('.tabContent  li').attr("ids", id);
		});

		/*--------------添加通知人------*/
		$('.imgs').eq(0).on('click', function() {
			$('.addH .title').html('添加通知人')
			$('.pages').fadeIn();
			$('.wrap').fadeOut();
			var id = "notify";
			$('.tabContent  li').attr("ids", id);
		});
		/*----------添加订单审核人---------*/
		$('.imgs').eq(1).on('click', function() {
			$('.addH .title').html('添加审核人')
			$('.pages').fadeIn();
			$('.wrap').fadeOut();
			var id = "reviewer";
			$('.tabContent li').attr("ids", id);
		});
		/*---------通知人和订单审核人的字符串拼接------*/
		function str(num, numbers, phone, id) {
			var str = `<li class="detail">
							<div class="detailEdtior">
								<p>
									<span class="name people">审核人</span>
									<span>${num}</span>
								</p>
								<p>
									<img src="../img/jian.png" / class="deleteEle">
								</p>
							</div>
							<div>
								<span class="name">手机号</span>
								<span>${phone}</span>
							</div>
							<div>
								<span class="name">身份证</span>
								<span>${numbers}</span>
							</div>
						</li>`;
			$('#' + id).empty().append(str);
		};
		/*------乘机人的字符串拼接-------*/
		function str1(num, numbers, phone) {
			var str = `<li class="detail">
							<div class="detailEdtior">
								<p>
									<span class="name people">乘机人</span>
									<span>${num}</span>
								</p>
								<p>
									<img src="../img/jian.png" / class="deleteEle">
								</p>
							</div>
							<div>
								<span class="name">身份证</span>
								<span>${numbers}</span>
							</div>
							<div>
								<span class="name">手机号</span>
								<span>${phone}</span>
							</div>
							<div class="detailEdtior">
								<p>
									<span class="name">费用归属</span>
									<span class="branch">人事部</span>
								</p>
								<p>
									<img src="../img/you.png" / class="chooseR deeeee">
								</p>
							</div>
							<div>
								<span class="name">项目号</span>
								<span>
								<input type="text" name="" id="" value="" / placeholder="选填">
							</span>
							</div>
							<div class="detailEdtior">
								<p>
									<span class="name">保险费</span>
									<span class="insurance">¥<span class="price">20</span>/份</span>
								</p>
								<div class="circle">
									<img src="../img/circle.png" class="circleBtn" id="circleBtn">
								</div>
							</div>
						</li>`;
			$('#passener').append(str);
		};
		/*-------添加通知人、审核人、乘机人弹框的点击事件----*/

		var numLength;
		var fare = parseFloat($('.fare').html());
		$('.tabContent  li').on('click', function() {
			addContent(this);
			numLength = $('.insurance .price').length;
			$('.footer .totalP').html(numLength * 20 + fare);
		});

		function addContent(obj) {
			var id = $(obj).attr("ids");
			var name = $(obj).find('.passener-name').html();
			var phone = $(obj).find('.passener-phone').html();
			var type = $(obj).find('.passener-type').html();
			if('passener' == id) {
				str1(name, type, phone);
			} else
				str(name, type, phone, id);
			$('.pages').fadeOut();
			$('.wrap').fadeIn();
		};
		/*----------点击编辑----------*/
		$('.edit').on('click', function(event) {
			event.stopPropagation(); //阻止事件冒泡即可
			window.location.href = "flyer.html";
		});

		/*-------删除列表内容-----*/
		$('body').on('click', '.deleteEle', function() {
			$(this).parents('.detail').remove();
			numLength = $('.insurance .price').length;
			$('.footer .totalP').html(numLength * 20 + fare);
		});

		/*-------费用归属的效果样式---------*/
		var objindex;
		var numberd = ($('.department .payment-choose p').length + 1) * 80 / 20 + 'rem';
		$('body').on('click', '.deeeee', function() {
			layerShow('.department', '.department .payment-con', numberd);
			objindex = $(this);
		});
		$('.department .payment-choose p').on('click', function() {
			chooseContent($(this), '.department')
			objindex.parents('.detailEdtior').find(".branch").html($(this).find('span').eq(0).html());
		});
		/*---------选择内容的事件函数-----*/
		function chooseContent(obj, ele) {
			obj.css('color', '#00AFEC').siblings().css('color', '');
			obj.find('.selected').show().parents(obj).siblings().find('.selected').hide();
			$(ele).delay(500).fadeOut(0);
		}
		/*------选项卡的效果--------*/
		$('.flyer').on('click', function() {
			var index = $(this).index();
			console.log(index)
			if(index == 1){
				$(this).parents('body').find('.addH .login img').css('display','block');
			}else{
				$(this).parents('body').find('.addH .login img').css('display','none');
			}
			$(this).addClass('highlight').siblings().removeClass('highlight');
			$(this).parents('.tabTitle').siblings().find('ul').eq(index).addClass('show').siblings().removeClass('show');
		});

		var url = window.location.href; //获取当前页面的url
		var len = url.length; //获取url的长度值
		var a = url.indexOf("?"); //获取第一次出现？的位置下标
		var b = url.substr(a + 1, len); //截取问号之后的内容
		var c = b.split("&"); //从指定的地方将字符串分割成字符串数组	
		var arr = new Array(); //新建一个数组
		for(var i = 0; i < c.length; i++) {
			var d = c[i].split("=")[1]; //从=处将字符串分割成字符串数组,并选择第2个元素			
		}
		$('.money .fare').html(c[0].split("=")[1]);
	</script>

</html>